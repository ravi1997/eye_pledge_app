{% extends "base.html" %}

{% block title %}Pledge Print - {{ pledge.reference_number }}{% endblock %}

{% block content %}
<style>
    @media print {
        @page {
            margin: 1cm;
            size: A4;
        }

        body {
            background: white !important;
            color: black !important;
            print-color-adjust: exact;
        }

        .no-print {
            display: none !important;
        }

        .print-only {
            display: block !important;
        }

        .panel {
            border: 1px solid #ccc !important;
            box-shadow: none !important;
            break-inside: avoid;
        }

        .signature-line {
            border-top: 1px solid #000;
        }
    }
</style>

<div class="max-w-4xl mx-auto p-4 sm:p-8 bg-white min-h-screen">

    <!-- Print Actions -->
    <div
        class="no-print mb-8 flex items-center justify-between bg-slate-50 p-4 rounded-xl border border-slate-200 shadow-sm">
        <div class="flex gap-3">
            <button onclick="window.print()"
                class="inline-flex items-center bg-brand-600 hover:bg-brand-700 text-white px-4 py-2 rounded-lg font-medium shadow transition-colors">
                <i class="bi bi-printer mr-2"></i> Print / Save PDF
            </button>
            <a href="{{ url_for('admin_pledge_detail', pledge_id=pledge.id) }}"
                class="inline-flex items-center bg-white border border-slate-300 hover:bg-slate-50 text-slate-700 px-4 py-2 rounded-lg font-medium transition-colors">
                <i class="bi bi-arrow-left mr-2"></i> Back
            </a>
        </div>
        <div class="text-sm text-slate-500">
            Use standard A4 settings for best results
        </div>
    </div>

    <!-- Document Content -->
    <div id="print-area" class="border border-transparent print:border-none">

        <!-- Header -->
        <div class="text-center border-b-4 border-brand-700 pb-4 mb-6">
            <h1 class="text-2xl font-bold text-brand-800 uppercase tracking-wide">National Eye Bank</h1>
            <p class="text-slate-600 text-sm mt-1">{{ institution_address }}</p>
            <p class="text-slate-500 text-xs mt-1">Email: {{ institution_email }}</p>
        </div>

        <div class="text-center mb-8">
            <h2 class="text-lg font-bold text-slate-900 uppercase underline decoration-2 underline-offset-4">Authority
                By Donor of Removal of Eyes (Pledge Form)</h2>
        </div>

        <div class="mb-8 text-justify text-sm leading-relaxed text-slate-800 px-2">
            <p>
                I hereby give my free and frank consent for the removal of my eyes after my death
                by a registered medical practitioner (Ophthalmic) of a recognized Eye Bank / Hospital
                for their use as medically suitable. I have been explained and I understand all the aspects
                of such a donation. I understand that the decision is completely voluntary and that I can
                revoke this pledge at any time.
            </p>
        </div>

        <!-- Donor Info -->
        <div class="mb-6 border border-slate-300 rounded p-4 panel">
            <h3 class="text-brand-700 font-bold border-b border-slate-200 pb-1 mb-3 text-sm uppercase">Donor Information
            </h3>
            <div class="grid grid-cols-2 gap-x-8 gap-y-2 text-sm">
                <div><span class="font-semibold w-24 inline-block text-slate-600">Name:</span> {{ pledge.donor_name }}
                </div>
                <div><span class="font-semibold w-24 inline-block text-slate-600">Mobile:</span> {{ pledge.donor_mobile
                    or '-' }}</div>
                <div><span class="font-semibold w-24 inline-block text-slate-600">Gender/Age:</span> {{ pledge.gender or
                    '-' }} / {{ pledge.age or '-' }}</div>
                <div><span class="font-semibold w-24 inline-block text-slate-600">Email:</span> {{ pledge.donor_email or
                    '-' }}</div>
                <div><span class="font-semibold w-24 inline-block text-slate-600">Blood Group:</span> {{
                    pledge.blood_group or '-' }}</div>
                <div><span class="font-semibold w-24 inline-block text-slate-600">Marital:</span> {{
                    pledge.marital_status or '-' }}</div>
            </div>

            <div class="mt-4 pt-3 border-t border-slate-100 text-sm">
                <span class="font-semibold text-slate-600 block mb-1">Address:</span>
                <div class="pl-24 -mt-6">
                    {{ pledge.address_line1 }}<br>
                    {% if pledge.address_line2 %}{{ pledge.address_line2 }}<br>{% endif %}
                    {{ pledge.city }}, {{ pledge.district }} - {{ pledge.pincode }}<br>
                    {{ pledge.state }}, {{ pledge.country }}
                </div>
            </div>

            {% if pledge.id_proof_type %}
            <div class="mt-2 text-sm">
                <span class="font-semibold text-slate-600">ID Proof:</span> {{ pledge.id_proof_type }} - {{
                pledge.id_proof_number }}
            </div>
            {% endif %}
        </div>

        <!-- Pledge Info -->
        <div class="mb-6 border border-slate-300 rounded p-4 panel">
            <h3 class="text-brand-700 font-bold border-b border-slate-200 pb-1 mb-3 text-sm uppercase">Pledge Details
            </h3>
            <div class="grid grid-cols-2 gap-x-8 gap-y-2 text-sm">
                <div><span class="font-semibold w-32 inline-block text-slate-600">Date of Pledge:</span> {{
                    pledge.date_of_pledge.strftime('%d-%m-%Y') }}</div>
                <div><span class="font-semibold w-32 inline-block text-slate-600">Time:</span> {{ pledge.time_of_pledge
                    or '-' }}</div>
                <div><span class="font-semibold w-32 inline-block text-slate-600">Organs:</span> {{
                    pledge.organs_consented }}</div>
                <div><span class="font-semibold w-32 inline-block text-slate-600">Language:</span> {{
                    pledge.language_preference }}</div>
                <div class="col-span-2"><span class="font-semibold w-32 inline-block text-slate-600">Preferred Eye
                        Bank:</span> {{ pledge.preferred_eye_bank or '-' }}</div>
            </div>
            {% if pledge.pledge_additional_notes %}
            <div class="mt-2 text-sm font-mono bg-slate-50 p-2 rounded">
                <span class="font-semibold text-slate-600 block">Notes:</span> {{ pledge.pledge_additional_notes }}
            </div>
            {% endif %}
        </div>

        <!-- Witnesses -->
        <div class="mb-8 border border-slate-300 rounded p-4 panel">
            <div class="grid grid-cols-2 gap-8">
                <div>
                    <h3 class="text-brand-700 font-bold border-b border-slate-200 pb-1 mb-3 text-sm uppercase">Witness 1
                        (Next of Kin)</h3>
                    <div class="text-sm space-y-1">
                        <p><span class="font-semibold text-slate-600">Name:</span> {{ pledge.witness1_name }}</p>
                        <p><span class="font-semibold text-slate-600">Relation:</span> {{ pledge.witness1_relationship
                            }}</p>
                        <p><span class="font-semibold text-slate-600">Mobile:</span> {{ pledge.witness1_mobile }}</p>
                    </div>
                </div>

                {% if pledge.witness2_name %}
                <div>
                    <h3 class="text-brand-700 font-bold border-b border-slate-200 pb-1 mb-3 text-sm uppercase">Witness 2
                    </h3>
                    <div class="text-sm space-y-1">
                        <p><span class="font-semibold text-slate-600">Name:</span> {{ pledge.witness2_name }}</p>
                        <p><span class="font-semibold text-slate-600">Relation:</span> {{ pledge.witness2_relationship
                            }}</p>
                        <p><span class="font-semibold text-slate-600">Mobile:</span> {{ pledge.witness2_mobile }}</p>
                    </div>
                </div>
                {% endif %}
            </div>
        </div>

        <!-- Signatures -->
        <div class="mt-16 flex justify-between items-end px-8 panel border-none">
            <div class="text-center w-1/3">
                <div class="signature-line pt-2">
                    <p class="font-bold text-sm">Donor's Signature</p>
                    <p class="text-xs text-slate-500">(Date & Time)</p>
                </div>
            </div>
            <div class="text-center w-1/3">
                <div class="signature-line pt-2">
                    <p class="font-bold text-sm">Witness Signature</p>
                    <p class="text-xs text-slate-500">(Date & Time)</p>
                </div>
            </div>
        </div>

        <!-- Footer / Official Use -->
        <div class="mt-16 flex justify-between items-end pt-4 border-t-2 border-slate-800">
            <div>
                <p class="text-sm font-bold">Reference Number:</p>
                <p class="text-2xl font-mono font-bold tracking-wider">{{ pledge.reference_number }}</p>
                <p class="text-xs text-slate-500">Recorded: {{ pledge.created_at.strftime('%d-%m-%Y %H:%M') }}</p>
            </div>
            <div class="text-right">
                <p class="text-sm font-bold mb-8">Official Stamp / Seal</p>
                <p class="text-xs text-slate-500">{{ institution_name }}</p>
            </div>
        </div>

    </div>
</div>
{% endblock %}