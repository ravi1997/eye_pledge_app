<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>{% block title %}Eye Donation Pledge Form{% endblock %}</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-icons/1.11.3/font/bootstrap-icons.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700;900&display=swap" rel="stylesheet">

    <style>
        :root{
            --bg: #f6f8fb;
            --surface: #ffffff;
            --muted: #6b7280;
            --text: #0f172a;
            --primary: #0b63b7; /* accessible blue */
            --primary-600: #0957a0;
            --accent: #0ea5a4;
            --easing: cubic-bezier(.2,.9,.2,1);
            --fast: 160ms;
            --medium: 320ms;
            --shadow-sm: 0 6px 20px rgba(15,23,42,0.06);
            --shadow-md: 0 12px 36px rgba(15,23,42,0.08);
            --success: #16a34a;
            --danger: #dc2626;
            --card-radius: 12px;
            --max-width: 1100px;
        }

        html,body{height:100%;}
        body{
            font-family: 'Inter', system-ui, -apple-system, 'Segoe UI', Roboto, 'Helvetica Neue', Arial;
            background: linear-gradient(180deg, var(--bg), #eef4fb 60%);
            color:var(--text);
            -webkit-font-smoothing:antialiased;
            -moz-osx-font-smoothing:grayscale;
            line-height:1.45;
            margin:0;
        }

        /* Skip link for keyboard users */
        .skip-link{
            position: absolute;
            left: -999px;
            top: auto;
            width: 1px;
            height: 1px;
            overflow: hidden;
        }
        .skip-link:focus{
            left: 1rem;
            top: 1rem;
            width: auto;
            height: auto;
            padding: 0.5rem 0.75rem;
            background: var(--primary);
            color: white;
            border-radius: 6px;
            z-index: 9999;
        }

        /* Navigation */
        .navbar{
            background: transparent;
            padding: 1rem 1.25rem;
        }
        .navbar-inner{
            max-width:var(--max-width);
            margin:0 auto;
            width:100%;
        }
        .navbar-brand{
            display:flex;align-items:center;gap:.6rem;font-weight:700;color:var(--primary);font-size:1.125rem;text-decoration:none;
        }
        .navbar .nav-link{color:var(--muted);font-weight:600;padding:.5rem .75rem;border-radius:8px;}
        .navbar .nav-link:hover{color:var(--text);background:rgba(11,99,183,0.06)}

        .hero{
            max-width:var(--max-width);
            margin:1.25rem auto;
            padding:1.25rem;
            display:flex;align-items:center;gap:1.25rem;flex-wrap:wrap;
            background:transparent;
        }
        .brand-mark{
            width:72px;height:72px;background:linear-gradient(135deg,var(--primary),var(--primary-600));border-radius:14px;display:flex;align-items:center;justify-content:center;color:white;font-weight:800;font-size:1.4rem;box-shadow:0 6px 18px rgba(11,99,183,0.15);
            transition: transform var(--medium) var(--easing), box-shadow var(--medium) var(--easing);
        }
        .hero-title{flex:1;min-width:220px}
        .hero-title h1{margin:0;font-size:1.5rem;font-weight:800;color:var(--text)}
        .hero-title p{margin:.35rem 0 0;color:var(--muted)}

        /* Main container */
        .container-main{max-width:var(--max-width);margin:1.25rem auto;padding:0 1rem}

        .card-surface{
            background:var(--surface);border-radius:var(--card-radius);padding:1.5rem;box-shadow:var(--shadow-sm);border:1px solid rgba(15,23,42,0.03);transition:transform var(--medium) var(--easing),box-shadow var(--medium) var(--easing);
        }

        .card-surface:hover{transform:translateY(-6px);box-shadow:var(--shadow-md)}

        .form-section{padding:1.25rem;border-radius:10px;background:linear-gradient(180deg,rgba(255,255,255,0.98),#fbfdff);box-shadow:0 6px 18px rgba(2,6,23,0.04);border:1px solid rgba(11,99,183,0.06)}
        .form-section h3{color:var(--primary);font-weight:700;margin-bottom:.75rem}
        .form-section{transition:transform var(--medium) var(--easing),box-shadow var(--medium) var(--easing)}
        .form-section:hover{transform:translateY(-4px);box-shadow:var(--shadow-md)}

        label{font-weight:600;color:var(--text)}
        .form-group.required label::after{content:" *";color:var(--danger)}

        .form-control:focus,.form-select:focus{box-shadow:0 6px 20px rgba(11,99,183,0.08);border-color:var(--primary)}

        .btn-primary{background:var(--primary);border:0;padding:.65rem 1.2rem;border-radius:10px;font-weight:700}
        .btn-primary{transition:transform var(--fast) var(--easing),box-shadow var(--fast) var(--easing),background-color var(--fast) var(--easing)}
        .btn-primary:hover{background:var(--primary-600);transform:translateY(-2px);box-shadow:0 8px 20px rgba(11,99,183,0.12)}

        .btn-outline-primary, .btn-outline-secondary{transition:transform var(--fast) var(--easing),color var(--fast) var(--easing),background-color var(--fast) var(--easing)}
        .btn-outline-primary:hover, .btn-outline-secondary:hover{transform:translateY(-2px)}

        .muted-small{color:var(--muted);font-size:.95rem}

        /* Link underline micro-interaction */
        a.text-decoration-none{position:relative}
        a.text-decoration-none::after{content:'';position:absolute;left:0;bottom:-2px;height:2px;width:0;background:var(--primary);transition:width var(--medium) var(--easing)}
        a.text-decoration-none:hover::after{width:100%}

        /* Alerts */
        .alert{border-radius:10px}

        footer{
            margin-top:2.5rem;padding:2rem 0;background:transparent;color:var(--muted);
        }
        .footer-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(220px,1fr));gap:1.25rem;max-width:var(--max-width);margin:0 auto;padding:0 1rem}
        .footer-brand{font-weight:700;color:var(--text);margin-bottom:.5rem}

        /* Utility */
        .text-accent{color:var(--accent)}

        /* Responsive tweaks */
        @media (min-width:768px){
            .hero-title h1{font-size:1.75rem}
        }

        /* Entrance animation */
        @keyframes fadeUp{from{opacity:0;transform:translateY(8px)}to{opacity:1;transform:none}}
        .animate-in{animation:fadeUp .48s var(--easing) both}

        /* Focus visible for accessibility */
        :focus-visible{outline:3px solid rgba(11,99,183,0.18);outline-offset:3px;border-radius:8px}

        /* Respect user motion preferences */
        @media (prefers-reduced-motion: reduce){
            .card-surface,.form-section,.btn-primary,.brand-mark{transition:none;animation:none}
        }

        @media print{
            .navbar, .btn, .skip-link{display:none}
            body{background:white}
            .form-section{box-shadow:none;border:none}
        }

        /* Preserve legacy helper classes used by other templates */
        .consent-box{background:#f0f7ff;border:2px solid var(--primary);padding:1.25rem;border-radius:8px;margin-bottom:1rem}
        .institution-header{text-align:center;margin-bottom:1.25rem;padding-bottom:.75rem;border-bottom:3px solid rgba(11,99,183,0.08)}
        .institution-header h2{color:var(--primary);font-weight:700}
        .witness-section{background:#fbfbfd;padding:1rem;border-radius:8px;border:1px solid #eef4fb}
    </style>

    {% block extra_css %}{% endblock %}
</head>
<body>
    <a class="skip-link" href="#main-content">Skip to content</a>

    <nav class="navbar" role="navigation" aria-label="Main navigation">
        <div class="navbar-inner">
            <div class="d-flex align-items-center justify-content-between">
                <a class="navbar-brand" href="{{ url_for('index') }}" aria-label="{{ institution_name }} home">
                    <span class="brand-mark" aria-hidden="true">EP</span>
                    <span class="d-none d-sm-inline">Eye Pledge</span>
                </a>

                <button class="navbar-toggler d-md-none btn btn-sm btn-outline-secondary" type="button" data-bs-toggle="collapse" data-bs-target="#nav-collapse" aria-controls="nav-collapse" aria-expanded="false" aria-label="Toggle navigation">
                    <i class="bi bi-list"></i>
                </button>
            </div>

            <div class="collapse d-md-block" id="nav-collapse">
                <ul class="nav justify-content-end">
                    <li class="nav-item"><a class="nav-link" href="{{ url_for('index') }}">Home</a></li>
                    <li class="nav-item"><a class="nav-link" href="{{ url_for('pledge_form') }}">Pledge Form</a></li>
                    {% if session.get('admin_user_id') %}
                    <li class="nav-item dropdown">
                        <a class="nav-link dropdown-toggle" href="#" id="adminDropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">Admin Panel</a>
                        <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="adminDropdown">
                            <li><a class="dropdown-item" href="{{ url_for('admin_dashboard') }}">Dashboard</a></li>
                            <li><a class="dropdown-item" href="{{ url_for('admin_pledges') }}">View Pledges</a></li>
                            <li><hr class="dropdown-divider"></li>
                            <li><a class="dropdown-item" href="{{ url_for('admin_logout') }}">Logout</a></li>
                        </ul>
                    </li>
                    {% else %}
                    <li class="nav-item"><a class="nav-link" href="{{ url_for('admin_login') }}">Admin</a></li>
                    {% endif %}
                </ul>
            </div>
        </div>
    </nav>

    <header class="hero" role="banner" aria-labelledby="site-title">
        <div class="brand-mark d-flex d-md-none" aria-hidden="true">EP</div>
        <div class="hero-title">
            <h1 id="site-title">{{ self.title() }}</h1>
            <p class="muted-small">A simple, secure pledge system to support sight restoration.</p>
        </div>
    </header>

    <main id="main-content" class="container-main" role="main">
        {% with messages = get_flashed_messages(with_categories=true) %}
            {% if messages %}
                <div class="card-surface mb-3">
                    {% for category, message in messages %}
                        <div class="alert alert-{{ 'danger' if category == 'error' else category }} alert-dismissible fade show" role="alert">
                            {{ message }}
                            <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
                        </div>
                    {% endfor %}
                </div>
            {% endif %}
        {% endwith %}

        {% block content %}{% endblock %}
    </main>

    <footer role="contentinfo">
        <div class="footer-grid">
            <div>
                <div class="footer-brand">{{ institution_name }}</div>
                <p class="muted-small">{{ institution_address }}</p>
            </div>
            <div>
                <h6 class="fw-semibold">Contact</h6>
                <p class="muted-small"><i class="bi bi-envelope"></i> {{ institution_email }}</p>
            </div>
            <div>
                <h6 class="fw-semibold">Quick Links</h6>
                <ul class="list-unstyled muted-small">
                    <li><a href="{{ url_for('index') }}" class="text-decoration-none">Home</a></li>
                    <li><a href="{{ url_for('pledge_form') }}" class="text-decoration-none">Pledge Form</a></li>
                    <li><a href="{{ url_for('admin_login') }}" class="text-decoration-none">Admin Login</a></li>
                </ul>
            </div>
        </div>

        <div class="text-center muted-small mt-3">&copy; 2025 {{ institution_name }}. All rights reserved.</div>
    </footer>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    {% block extra_js %}{% endblock %}
</body>
</html>