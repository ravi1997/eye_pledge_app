<!-- templates/base.html -->
<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>{% block title %}Eye Donation Pledge Form{% endblock %}</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-icons/1.11.3/font/bootstrap-icons.min.css"
        rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@400;500;600;700;800&display=swap"
        rel="stylesheet">

    <style>
        :root {
            --bg: #0b1221;
            --bg-soft: #f6f8fb;
            --surface: #ffffff;
            --muted: #667085;
            --text: #0f172a;
            --primary: #2155ff;
            --primary-600: #1a47d4;
            --accent: #0ea5e9;
            --accent-warm: #f59e0b;
            --success: #16a34a;
            --danger: #dc2626;
            --border: rgba(15, 23, 42, 0.08);
            --shadow-sm: 0 8px 24px rgba(15, 23, 42, 0.05);
            --shadow-md: 0 16px 42px rgba(15, 23, 42, 0.09);
            --shadow-xl: 0 24px 68px rgba(15, 23, 42, 0.15);
            --radius-lg: 16px;
            --radius-md: 12px;
            --radius-sm: 10px;
            --max-width: 1180px;
            --easing: cubic-bezier(.22, .61, .36, 1);
            --fast: 140ms;
            --medium: 320ms;
        }

        html,
        body {
            height: 100%;
        }

        body {
            font-family: 'Plus Jakarta Sans', system-ui, -apple-system, 'Segoe UI', Roboto, 'Helvetica Neue', Arial;
            background:
                radial-gradient(900px 900px at 15% 10%, rgba(33, 85, 255, 0.08), transparent 50%),
                radial-gradient(700px 700px at 85% 0%, rgba(14, 165, 233, 0.08), transparent 48%),
                linear-gradient(180deg, #f7f9fc 0%, #eef2f8 100%);
            color: var(--text);
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
            line-height: 1.6;
            margin: 0;
            position: relative;
        }

        body::after {
            content: "";
            position: fixed;
            inset: 0;
            background:
                linear-gradient(120deg, rgba(33, 85, 255, 0.06), transparent 35%),
                linear-gradient(300deg, rgba(14, 165, 233, 0.06), transparent 40%);
            pointer-events: none;
            z-index: -1;
        }

        ::selection {
            background: rgba(33, 85, 255, 0.14);
        }

        /* Skip link for keyboard users */
        .skip-link {
            position: absolute;
            left: -999px;
            top: auto;
            width: 1px;
            height: 1px;
            overflow: hidden;
        }

        .skip-link:focus {
            left: 1rem;
            top: 1rem;
            width: auto;
            height: auto;
            padding: 0.6rem 0.85rem;
            background: var(--primary);
            color: white;
            border-radius: 10px;
            box-shadow: var(--shadow-md);
            z-index: 9999;
        }

        /* Navigation */
        .navbar {
            background: transparent;
            padding: 0.75rem 1.25rem;
            position: sticky;
            top: 0;
            z-index: 1000;
        }

        .navbar-inner {
            max-width: var(--max-width);
            margin: 0 auto;
            width: 100%;
            background: rgba(255, 255, 255, 0.86);
            backdrop-filter: blur(18px);
            border: 1px solid rgba(255, 255, 255, 0.6);
            box-shadow: var(--shadow-sm);
            border-radius: 20px;
            padding: 0.35rem 0.75rem;
        }

        .navbar-brand {
            display: flex;
            align-items: center;
            gap: .65rem;
            font-weight: 800;
            color: var(--text);
            font-size: 1.05rem;
            text-decoration: none;
            letter-spacing: -0.01em;
        }

        .brand-mark {
            width: 48px;
            height: 48px;
            background: linear-gradient(135deg, var(--primary), var(--primary-600));
            border-radius: 14px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: 800;
            font-size: 1.05rem;
            box-shadow: 0 10px 24px rgba(33, 85, 255, 0.18);
            transition: transform var(--medium) var(--easing), box-shadow var(--medium) var(--easing);
        }

        .brand-mark:hover {
            transform: translateY(-3px) rotate(-2deg);
            box-shadow: var(--shadow-md);
        }

        .navbar .nav-link {
            color: var(--muted);
            font-weight: 600;
            padding: .6rem .9rem;
            border-radius: 12px;
            transition: color var(--fast) var(--easing), background-color var(--fast) var(--easing), transform var(--fast) var(--easing);
        }

        .navbar .nav-link:hover {
            color: var(--text);
            background: rgba(33, 85, 255, 0.07);
            transform: translateY(-1px);
        }

        .navbar .nav-link.active {
            color: var(--text);
            background: rgba(33, 85, 255, 0.12);
            box-shadow: 0 8px 18px rgba(33, 85, 255, 0.12);
        }

        .navbar .dropdown-menu {
            border-radius: var(--radius-md);
            box-shadow: var(--shadow-md);
            border: 1px solid var(--border);
        }

        .navbar-toggler {
            border-radius: 12px;
        }

        /* Hero */
        .hero {
            max-width: var(--max-width);
            margin: 1.2rem auto;
            padding: 1.25rem 1rem 0.25rem;
            display: flex;
            align-items: center;
            gap: 1.25rem;
            flex-wrap: wrap;
            position: relative;
        }

        .hero::after {
            content: "";
            position: absolute;
            inset: 0;
            background: linear-gradient(120deg, rgba(33, 85, 255, 0.05), transparent 40%);
            border-radius: 26px;
            z-index: -1;
        }

        .hero-title {
            flex: 1;
            min-width: 260px
        }

        .hero-title h1 {
            margin: 0;
            font-size: 1.6rem;
            font-weight: 800;
            color: var(--text);
            letter-spacing: -0.02em
        }

        .hero-title p {
            margin: .35rem 0 0;
            color: var(--muted);
            max-width: 52ch
        }

        /* Main container */
        .container-main {
            max-width: var(--max-width);
            margin: 1.25rem auto;
            padding: 0 1.25rem;
            position: relative;
            z-index: 1;
        }

        /* Surfaces */
        .card-surface {
            background: linear-gradient(180deg, rgba(255, 255, 255, 0.96), #f9fbff);
            border-radius: var(--radius-lg);
            padding: 1.5rem;
            box-shadow: var(--shadow-sm);
            border: 1px solid var(--border);
            transition: transform var(--medium) var(--easing), box-shadow var(--medium) var(--easing), border-color var(--medium) var(--easing);
        }

        .card-surface:hover {
            transform: translateY(-3px);
            box-shadow: var(--shadow-md);
            border-color: rgba(33, 85, 255, 0.16);
        }

        .form-section {
            padding: 1.4rem;
            border-radius: var(--radius-md);
            background: linear-gradient(180deg, rgba(255, 255, 255, 0.98), #f7fbff);
            box-shadow: 0 10px 30px rgba(2, 6, 23, 0.08);
            border: 1px solid rgba(33, 85, 255, 0.1);
            transition: transform var(--medium) var(--easing), box-shadow var(--medium) var(--easing);
        }

        .form-section h3 {
            color: var(--text);
            font-weight: 700;
            margin-bottom: .75rem
        }

        .form-section:hover {
            transform: translateY(-3px);
            box-shadow: var(--shadow-md)
        }

        label {
            font-weight: 600;
            color: var(--text)
        }

        .form-group.required label::after {
            content: " *";
            color: var(--danger)
        }

        .form-control,
        .form-select {
            border-radius: 12px;
            border: 1px solid var(--border);
            padding: .7rem .9rem;
        }

        .form-control:focus,
        .form-select:focus {
            box-shadow: 0 10px 28px rgba(33, 85, 255, 0.12);
            border-color: var(--primary)
        }

        /* Buttons */
        .btn {
            font-weight: 700;
            border-radius: 12px;
        }

        .btn-primary {
            background: linear-gradient(120deg, var(--primary), var(--primary-600));
            border: 0;
            padding: .72rem 1.25rem;
            box-shadow: 0 12px 30px rgba(33, 85, 255, 0.28);
            transition: transform var(--fast) var(--easing), box-shadow var(--fast) var(--easing), filter var(--fast) var(--easing);
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 16px 38px rgba(33, 85, 255, 0.34);
            filter: saturate(1.05);
        }

        .btn-outline-primary,
        .btn-outline-secondary {
            transition: transform var(--fast) var(--easing), color var(--fast) var(--easing), background-color var(--fast) var(--easing), border-color var(--fast) var(--easing);
            padding: .68rem 1.1rem;
        }

        .btn-outline-primary:hover {
            transform: translateY(-2px);
            background: rgba(33, 85, 255, 0.08);
            border-color: var(--primary);
            color: var(--primary)
        }

        .btn-outline-secondary:hover {
            transform: translateY(-2px);
            background: rgba(15, 23, 42, 0.05);
            color: var(--text)
        }

        .muted-small {
            color: var(--muted);
            font-size: .95rem
        }

        /* Link underline micro-interaction */
        a.text-decoration-none {
            position: relative
        }

        a.text-decoration-none::after {
            content: '';
            position: absolute;
            left: 0;
            bottom: -4px;
            height: 2px;
            width: 0;
            background: var(--primary);
            transition: width var(--medium) var(--easing)
        }

        a.text-decoration-none:hover::after {
            width: 100%
        }

        /* Alerts */
        .alert {
            border-radius: 12px;
            border: 1px solid var(--border);
            box-shadow: var(--shadow-sm);
        }

        /* Footer */
        footer {
            margin-top: 2.5rem;
            padding: 2.5rem 0;
            background: transparent;
            color: var(--muted);
        }

        .footer-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
            gap: 1.5rem;
            max-width: var(--max-width);
            margin: 0 auto;
            padding: 0 1.25rem
        }

        .footer-brand {
            font-weight: 800;
            color: var(--text);
            margin-bottom: .4rem;
            letter-spacing: -0.01em
        }

        .footer-grid h6 {
            font-weight: 700;
        }

        /* Utility */
        .text-accent {
            color: var(--accent)
        }

        .pill {
            display: inline-flex;
            align-items: center;
            gap: .35rem;
            padding: .35rem .75rem;
            border-radius: 999px;
            background: rgba(33, 85, 255, 0.09);
            color: var(--primary);
            font-weight: 700;
            font-size: .9rem;
            letter-spacing: -0.01em;
        }

        .eyebrow {
            text-transform: uppercase;
            letter-spacing: 0.12em;
            font-size: .78rem;
            color: var(--muted);
            font-weight: 700;
        }

        .tilt-lift {
            transition: transform var(--medium) var(--easing), box-shadow var(--medium) var(--easing);
        }

        .tilt-lift:hover {
            transform: translateY(-3px);
            box-shadow: var(--shadow-md);
        }

        .tilt-lift-strong:hover {
            transform: translateY(-6px);
            box-shadow: var(--shadow-xl);
        }

        .grid-auto {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(260px, 1fr));
            gap: 1rem;
        }

        .stat-card {
            padding: 1rem 1.1rem;
            border-radius: var(--radius-md);
            background: linear-gradient(145deg, rgba(33, 85, 255, 0.12), rgba(14, 165, 233, 0.12));
            border: 1px solid rgba(33, 85, 255, 0.15);
            color: var(--text);
            box-shadow: var(--shadow-sm);
        }

        .stat-card h5 {
            margin: 0;
            font-weight: 800;
        }

        .stat-card p {
            margin: 0;
            color: var(--muted);
        }

        .divider-soft {
            height: 1px;
            width: 100%;
            background: linear-gradient(90deg, transparent, rgba(15, 23, 42, 0.08), transparent);
            margin: 1rem 0;
        }

        .icon-circle {
            width: 46px;
            height: 46px;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            border-radius: 14px;
            background: linear-gradient(135deg, rgba(33, 85, 255, 0.12), rgba(14, 165, 233, 0.14));
            color: var(--primary);
            box-shadow: 0 10px 25px rgba(33, 85, 255, 0.18);
        }

        .feature-tile {
            border: 1px solid var(--border);
            border-radius: var(--radius-md);
            background: linear-gradient(145deg, rgba(255, 255, 255, 0.98), rgba(247, 250, 255, 0.96));
            padding: 1.1rem;
            height: 100%;
            transition: transform var(--medium) var(--easing), box-shadow var(--medium) var(--easing), border-color var(--medium) var(--easing);
        }

        .feature-tile:hover {
            transform: translateY(-3px);
            box-shadow: var(--shadow-md);
            border-color: rgba(33, 85, 255, 0.18);
        }

        .feature-tile h6 {
            font-weight: 700;
            margin: 0 0 .4rem;
        }

        .feature-tile .muted-small {
            margin: 0;
        }

        .callout {
            border-radius: var(--radius-md);
            padding: 1rem 1.1rem;
            background: linear-gradient(120deg, rgba(14, 165, 233, 0.08), rgba(255, 255, 255, 0.92));
            border: 1px solid rgba(14, 165, 233, 0.24);
        }

        .timeline {
            position: relative;
            padding-left: 1.6rem;
            margin-top: 1rem;
        }

        .timeline::before {
            content: "";
            position: absolute;
            left: .6rem;
            top: .1rem;
            bottom: .1rem;
            width: 2px;
            background: linear-gradient(180deg, rgba(33, 85, 255, 0.25), rgba(33, 85, 255, 0.05));
        }

        .timeline-step {
            display: flex;
            gap: .75rem;
            margin-bottom: 1.25rem;
            align-items: flex-start;
        }

        .timeline-dot {
            width: 18px;
            height: 18px;
            border-radius: 50%;
            background: linear-gradient(135deg, var(--primary), var(--accent));
            box-shadow: 0 10px 26px rgba(33, 85, 255, 0.3);
            margin-right: .25rem;
            position: relative;
            top: .2rem;
        }

        .timeline-body h6 {
            margin: 0;
            font-weight: 700;
        }

        .timeline-body p {
            margin: 0;
            color: var(--muted);
        }

        /* Responsive tweaks */
        @media (min-width:768px) {
            .hero-title h1 {
                font-size: 1.9rem
            }
        }

        /* Entrance animation */
        @keyframes fadeUp {
            from {
                opacity: 0;
                transform: translateY(10px)
            }

            to {
                opacity: 1;
                transform: none
            }
        }

        .animate-in {
            animation: fadeUp .52s var(--easing) both
        }

        /* Focus visible for accessibility */
        :focus-visible {
            outline: 3px solid rgba(33, 85, 255, 0.32);
            outline-offset: 3px;
            border-radius: 10px
        }

        /* Respect user motion preferences */
        @media (prefers-reduced-motion: reduce) {

            .card-surface,
            .form-section,
            .btn-primary,
            .brand-mark,
            .tilt-lift,
            .animate-in {
                transition: none;
                animation: none
            }
        }

        @media print {

            .navbar,
            .btn,
            .skip-link {
                display: none
            }

            body {
                background: white
            }

            .form-section {
                box-shadow: none;
                border: none
            }
        }

        /* Preserve legacy helper classes used by other templates */
        .consent-box {
            background: #f0f7ff;
            border: 2px solid var(--primary);
            padding: 1.25rem;
            border-radius: 8px;
            margin-bottom: 1rem
        }

        .institution-header {
            text-align: center;
            margin-bottom: 1.25rem;
            padding-bottom: .75rem;
            border-bottom: 3px solid rgba(11, 99, 183, 0.08)
        }

        .institution-header h2 {
            color: var(--primary);
            font-weight: 700
        }

        .witness-section {
            background: #fbfbfd;
            padding: 1rem;
            border-radius: 8px;
            border: 1px solid #eef4fb
        }
    </style>

    {% block extra_css %}{% endblock %}
</head>

<body>
    <a class="skip-link" href="#main-content">Skip to content</a>

    <nav class="navbar" role="navigation" aria-label="Main navigation">
        <div class="navbar-inner">
            <div class="d-flex align-items-center justify-content-between">
                <a class="navbar-brand" href="{{ url_for('index') }}" aria-label="{{ institution_name }} home">
                    <span class="brand-mark" aria-hidden="true">EP</span>
                    <span class="d-none d-sm-inline">Eye Pledge</span>
                </a>

                <button class="navbar-toggler d-md-none btn btn-sm btn-outline-secondary" type="button"
                    data-bs-toggle="collapse" data-bs-target="#nav-collapse" aria-controls="nav-collapse"
                    aria-expanded="false" aria-label="Toggle navigation">
                    <i class="bi bi-list"></i>
                </button>
            </div>

            <div class="collapse d-md-block" id="nav-collapse">
                <ul class="nav justify-content-end">
                    <li class="nav-item">
                        <a id="nav-home" class="nav-link {% if request.path == '/' %}active{% endif %}"
                            href="{{ url_for('index') }}" data-active-path="{{ url_for('index') }}" {% if
                            request.path=='/' %}aria-current="page" {% endif %}>Home</a>
                    </li>
                    <li class="nav-item">
                        <a id="nav-pledge" class="nav-link {% if request.path == '/pledge' %}active{% endif %}"
                            href="{{ url_for('pledge_form') }}" data-active-path="{{ url_for('pledge_form') }}" {% if
                            request.path=='/pledge' %}aria-current="page" {% endif %}>Pledge Form</a>
                    </li>
                    {% if session.get('admin_user_id') %}
                    <li class="nav-item dropdown">
                        <a class="nav-link dropdown-toggle" href="#" id="adminDropdown" role="button"
                            data-bs-toggle="dropdown" aria-expanded="false">Admin Panel</a>
                        <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="adminDropdown">
                            <li><a class="dropdown-item" href="{{ url_for('admin_dashboard') }}">Dashboard</a></li>
                            <li><a class="dropdown-item" href="{{ url_for('admin_pledges') }}">View Pledges</a></li>
                            <li>
                                <hr class="dropdown-divider">
                            </li>
                            <li><a class="dropdown-item" href="{{ url_for('admin_logout') }}">Logout</a></li>
                        </ul>
                    </li>
                    {% else %}
                    <li class="nav-item">
                        <a id="nav-admin" class="nav-link {% if request.path == '/admin/login' %}active{% endif %}"
                            href="{{ url_for('admin_login') }}" data-active-path="{{ url_for('admin_login') }}" {% if
                            request.path=='/admin/login' %}aria-current="page" {% endif %}>Admin</a>
                    </li>
                    {% endif %}
                </ul>
            </div>
        </div>
    </nav>

    <header class="hero" role="banner" aria-labelledby="site-title">
        {% block hero_content %}
        <div class="brand-mark d-flex d-md-none" aria-hidden="true">EP</div>
        <div class="hero-title">
            <h1 id="site-title">{{ self.title() }}</h1>
            <p class="muted-small">A simple, secure pledge system to support sight restoration.</p>
        </div>
        {% endblock %}
    </header>

    <main id="main-content" class="container-main" role="main">
        {% with messages = get_flashed_messages(with_categories=true) %}
        {% if messages %}
        <div class="card-surface mb-3">
            {% for category, message in messages %}
            <div class="alert alert-{{ 'danger' if category == 'error' else category }} alert-dismissible fade show"
                role="alert">
                {{ message }}
                <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
            </div>
            {% endfor %}
        </div>
        {% endif %}
        {% endwith %}

        {% block content %}{% endblock %}
    </main>

    <footer role="contentinfo">
        <div class="footer-grid">
            <div>
                <div class="footer-brand">{{ institution_name }}</div>
                <p class="muted-small">{{ institution_address if institution_address|trim else "Address: Available on
                    request" }}</p>
            </div>
            <div>
                <h6 class="fw-semibold">Contact</h6>
                <p class="muted-small"><i class="bi bi-envelope"></i> {{ institution_email }}</p>
            </div>
            <div>
                <h6 class="fw-semibold">Quick Links</h6>
                <ul class="list-unstyled muted-small">
                    <li><a href="{{ url_for('index') }}" class="text-decoration-none">Home</a></li>
                    <li><a href="{{ url_for('pledge_form') }}" class="text-decoration-none">Pledge Form</a></li>
                    <li><a href="{{ url_for('admin_login') }}" class="text-decoration-none">Admin Login</a></li>
                </ul>
            </div>
        </div>

        <div class="text-center muted-small mt-3">&copy; 2025 {{ institution_name }}. All rights reserved.</div>
    </footer>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        // Highlight active nav based on path when server-side active class is unavailable.
        (function () {
            var path = (window.location.pathname || "/").replace(/\/+$/, '') || "/";
            var links = document.querySelectorAll('.nav-link[data-active-path]');
            links.forEach(function (link) {
                var target = (link.getAttribute('data-active-path') || '').replace(/\/+$/, '') || "/";
                if (target === path && !link.classList.contains('active')) {
                    link.classList.add('active');
                    link.setAttribute('aria-current', 'page');
                }
            });
        })();
    </script>
    {% block extra_js %}{% endblock %}
</body>

</html>